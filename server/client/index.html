<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Windward – Fleets</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; margin: 24px; }
    h2 { margin: 0 0 12px; }
    .muted { color:#666; font-size:12px; margin: 6px 0 16px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ddd; padding: 8px; }
    th { background: #f6f6f6; text-align: left; cursor: pointer; }
  </style>
</head>
<body>
  <h2>Fleets</h2>
  <div class="muted">Click a column header to sort.</div>
  <div id="root"></div>
  <script type="text/babel">
    const { useEffect, useMemo, useState } = React;
    function App() {
      const [rows, setRows] = useState([]);
      const [sort, setSort] = useState({ field: 'name', asc: true });
      useEffect(() => { fetch('/fleets').then(r=>r.json()).then(setRows).catch(()=>{}); }, []);
      const sorted = useMemo(() => {
        const copy = rows.slice();
        copy.sort((a,b)=>{const f=sort.field;const A=(a[f]??'').toString().toLowerCase();const B=(b[f]??'').toString().toLowerCase();if(A<B)return sort.asc?-1:1;if(A>B)return sort.asc?1:-1;return 0;});
        return copy;
      }, [rows, sort]);
      const toggle = (field)=>setSort(s=>({field,asc:s.field===field?!s.asc:true}));
      return (
        <table>
          <thead>
            <tr>
              <th onClick={()=>toggle('name')}>Name {sort.field==='name'?(sort.asc?'▲':'▼'):''}</th>
              <th onClick={()=>toggle('count')}>Vessels {sort.field==='count'?(sort.asc?'▲':'▼'):''}</th>
            </tr>
          </thead>
          <tbody>
            {sorted.map(f=>(
              <tr key={f._id}>
                <td>{f.name || '(unnamed)'}</td>
                <td>{f.count ?? 0}</td>
              </tr>
            ))}
          </tbody>
        </table>
      );
    }
    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
